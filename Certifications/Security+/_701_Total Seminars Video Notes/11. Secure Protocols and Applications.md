
# DNS Security

## Common Secure Protocols
#### DNS
- TCP/UDP port 53
- Domain Hijacking
- URL redirection
- Cache poisoning
- Domain Name System Security Extensions (DNSSEC)
	- All DNS zones have certificates
#### Simple Network Management Protocol (SNMP)
- UDP port 161/162
- Version 1,2,3

## Common Secure Protocols
#### Secure Shell (SSH)
- TCP 22
#### Secured File Transfer Protocol/FTP over SSL (FTPS)
- TCP port 990
#### SSH FTP (SFTP)
- TCP port 22
#### Secure Real-Time Transport Protocol (SRTP)
- UDP port 5004

# FTP Packet Capture

![[Pasted image 20240719003103.png]]

![[Pasted image 20240719003120.png]]

![[Pasted image 20240719003152.png]]

# Secure Web and E-mail


## Securing Web Apps
#### Can be accessible internally or externally
#### Hide true web server IP address
- Load balancing
- Reverse proxying 
- Network Address Translation (NAT)

#### HTTPS
- Enabled on the web server 
- Requires a server PKI certificate
- Uses TCP port 443 instead of 80
- TLS
	- Uses version 1.2 or higher

![[Pasted image 20240719003503.png]]

![[Pasted image 20240719003522.png]]

![[Pasted image 20240719003540.png]]

![[Pasted image 20240719003742.png]]

## Web App User Authentication

#### Lightweight Directory Access Protocol Over SSL (LDAPS)
- Directory service access protocol
- Supported by Microsoft Active Directory
- Requires a server PKI certificate
- Uses TCP port 636 instead of 389
#### On-premises and cloud

## Simple Mail Transfer Protocol (SMTP) 
#### Domain reputation
- Determines if mail will be received by other SMTP hosts
#### Secure/Multipurpose Internet Mail Extensions (S/MIME)
- Encrypt and sign e-mail messages
- Requires a client PKI certificate

## E-Mail Protocols 
#### SMTP
- E-mail transfer protocol
#### Post Office Protocol (POP)
- Client e-mail retrieval protocol
#### Internet Message Access Protocol (IMAP)
- Client e-mail retrieval protocol
#### Each can be secured with a server PKI certificate


# Request Forgery Attacks

## Request Forgeries
#### Cross-Site Request Forgery (CSRF)
- Targets users and unchanging session tokens
- Designed to hijack authenticated sessions between a client and a server

#### Server-side request forgery (SSRF)
- Targets web servers
- Designed to have server make HTTP requests to other services
![[Pasted image 20240719004622.png]]

## Request Forgeries

#### Mitigation
- Harden client devices
- Use web application firewall (WAF)

# Cross-Site Scripting Attacks

## Cross-Site Scripting (XSS) Attack

#### Starts with a web app that doesn't properly validate or sanitize input
- All user input must be untrusted
#### Attacker injects malicious code into vulnerable website
- JavaScript is commonly used

#### Website visitors unknowingly execute malicious code

![[Pasted image 20240719005025.png]]

![[Pasted image 20240719005044.png]]

![[Pasted image 20240719005119.png]]

![[Pasted image 20240719005127.png]]

![[Pasted image 20240719005150.png]]



# Web Application Security

## Web App Security

##### For web server admins and web app developers
##### Harden public-facing and private web apps

## Injection Attacks
#### Malicious user input is accepted by the web app
#### Types
- Structured Query Language (SQL)
- Lightweight Directory Access Protocol (LDAP)
- Extensible Markup Language (XML)
#### Mitigation
- Sanitize all user input

## Secure Coding
#### Software development security best practices
- Input validation
- Secure web browser cookies
- HTTP headers
- Code signing
- Use trusted components and APIs

![[Pasted image 20240719005546.png]]

## Continuous Integration and Continuous Delivery (CI/CD)
##### Automate developer code changes
##### Test for quality assurance
##### Send update notifications to users for code version control
##### Security issues
- Attackers could make changes and inject into the update

## Infrastructure As Code
##### VM templates
##### Cloud templates
#### Rapid and consistent provisioning/ deprovisioning
- Useful for sandbox testing
#### Security issues
- Attackers could modify templates

## Software Testing
#### Static testing
- Code review
- Manually scanning code
#### Dynamic testing
- Observe runtime behavior 
#### Fuzzing 
- Provide app with unexpected data

# OWASP Top 10

# Web App Vulnerability Scanning

